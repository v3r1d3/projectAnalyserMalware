import logging
import os
import time

from utils.custom_logger import log
from utils.scan_code import scan_code


def main():
    path = input('Path to the project/file to be analysed: ')

    if not os.path.exists(path):
        log('Path doesn\'t exist :(', logging.ERROR)
        return main()

    if os.path.isfile(path):
        try:
            scan_code(path)
        except Exception as e:
            log(f'Error when scanning file {path} - {e}', logging.CRITICAL)
    else:
        for root, dirs, files in os.walk(path):
            for file in files:
                if file.endswith(".py"):
                    file_path = os.path.join(root, file)
                    try:
                        scan_code(file_path)
                    except Exception as e:
                        log(f'Error when scanning file {file_path} - {e}', logging.CRITICAL)


if __name__ == '__main__':
    log("""
     @@@@@@    @@@@@@@  @@@@@@@@   @@@@@@   @@@  @@@   @@@@@@   @@@@@@@   @@@   @@@@@@@  
    @@@@@@@@  @@@@@@@@  @@@@@@@@  @@@@@@@@  @@@@ @@@  @@@@@@@@  @@@@@@@@  @@@  @@@@@@@@  
    @@!  @@@  !@@       @@!       @@!  @@@  @@!@!@@@  @@!  @@@  @@!  @@@  @@!  !@@       
    !@!  @!@  !@!       !@!       !@!  @!@  !@!!@!@!  !@!  @!@  !@!  @!@  !@!  !@!       
    @!@  !@!  !@!       @!!!:!    @!@!@!@!  @!@ !!@!  @!@!@!@!  @!@!!@!   !!@  !@!       
    !@!  !!!  !!!       !!!!!:    !!!@!!!!  !@!  !!!  !!!@!!!!  !!@!@!    !!!  !!!       
    !!:  !!!  :!!       !!:       !!:  !!!  !!:  !!!  !!:  !!!  !!: :!!   !!:  :!!       
    :!:  !:!  :!:       :!:       :!:  !:!  :!:  !:!  :!:  !:!  :!:  !:!  :!:  :!:       
    ::::: ::   ::: :::   :: ::::  ::   :::   ::   ::  ::   :::  ::   :::   ::   ::: :::  
     : :  :    :: :: :  : :: ::    :   : :  ::    :    :   : :   :   : :  :     :: :: :  


                      @@@  @@@   @@@@@@    @@@@@@        @@@   @@@@@@                    
                      @@@  @@@  @@@@@@@   @@@@@@@        @@@  @@@@@@@                    
                      @@!  !@@  !@@       !@@            @@!  !@@                        
                      !@!  @!!  !@!       !@!            !@!  !@!                        
                       !@@!@!   !!@@!!    !!@@!!         !!@  !!@@!!                     
                        @!!!     !!@!!!    !!@!!!        !!!   !!@!!!                    
                       !: :!!        !:!       !:!       !!:       !:!                   
                      :!:  !:!      !:!       !:!   :!:  :!:      !:!                    
                       ::  :::  :::: ::   :::: ::   :::   ::  :::: ::                    
                       :   ::   :: : :    :: : :    :::  :    :: : :                     

        """, center=True)

    time.sleep(3)

    main()
